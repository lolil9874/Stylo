/* Import de la police Inter (similaire à Intel One) */
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

/* Reset et base */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: transparent;
    overflow: hidden;
    user-select: none;
    -webkit-user-select: none;
}

/* Floating panel with liquid glass effect */
.floating-panel {
    width: 100%;
    height: 100vh;
    display: flex;
    align-items: flex-start;
    justify-content: center;
    background: rgba(255, 255, 255, 0.8);
    backdrop-filter: blur(15px);
    -webkit-backdrop-filter: blur(15px);
    border-radius: 8px;
    position: relative;
    cursor: move;
    overflow: visible;
    border: 1px solid rgba(255, 255, 255, 0.3);
    box-shadow: 
        0 4px 20px rgba(0, 0, 0, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.5);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Hover effect for floating panel */
.floating-panel:hover {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.4);
    box-shadow: 
        0 8px 30px rgba(0, 0, 0, 0.15),
        inset 0 1px 0 rgba(255, 255, 255, 0.6);
    transform: translateY(-2px);
}

/* Bordure avec dégradé angulaire comme dans le SVG */
.gradient-border {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    border-radius: 8px;
    background: conic-gradient(
        from 90deg,
        rgba(0, 0, 0, 0.184) 0deg,
        rgba(0, 0, 0, 0.352) 42.984deg,
        rgba(0, 0, 0, 0) 132.984deg,
        rgba(0, 0, 0, 0.352) 222.984deg,
        rgba(0, 0, 0, 0) 312.984deg,
        rgba(0, 0, 0, 0.184) 360deg
    );
    mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    mask-composite: xor;
    -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    padding: 0.5px;
    z-index: 1;
    pointer-events: none !important;
}

/* Zone de déplacement */
.draggable-area {
    -webkit-app-region: drag;
}

/* Button container */
.button-container {
    display: flex;
    gap: 12px;
    padding: 0 12px;
    align-items: center;
    -webkit-app-region: no-drag;
    position: relative;
    z-index: 2;
}

/* Inline status line under the buttons */
.status-line {
    position: absolute;
    top: 48px;
    left: 12px;
    right: 12px;
    min-height: 0;
    padding: 6px 10px;
    font-size: 12px;
    line-height: 1.4;
    color: #111827;
    background: rgba(255, 255, 255, 0.9);
    border: 1px solid rgba(0, 0, 0, 0.06);
    border-radius: 6px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    opacity: 0;
    transform: translateY(-6px);
    transition: opacity 160ms ease, transform 160ms ease;
    pointer-events: none;
}

.status-line.show {
    opacity: 1;
    transform: translateY(0);
}

.status-line.error { color: #991b1b; background: #fee2e2; border-color: #fecaca; }
.status-line.warning { color: #92400e; background: #fef3c7; border-color: #fde68a; }
.status-line.info { color: #1e3a8a; background: #dbeafe; border-color: #bfdbfe; }
.status-line.success { color: #065f46; background: #d1fae5; border-color: #a7f3d0; }

/* Button style */
.action-button {
    position: relative;
    width: 32px;
    height: 32px;
    border: none;
    border-radius: 6px;
    background: transparent;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    -webkit-app-region: no-drag;
}

/* Hover animation */
.action-button:hover {
    transform: translateY(-1px);
    background: rgba(0, 0, 0, 0.08);
}

/* Animation de clic */
.action-button:active {
    transform: translateY(0) scale(0.95);
    transition: all 0.1s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Active state (selected button) */
.action-button.active {
    background: transparent;
    transform: translateY(-1px);
}

/* Animation de transition entre les états */
.action-button:not(.active) {
    color: rgba(0, 0, 0, 0.3);
}

.action-button:not(.active):hover {
    color: rgba(0, 0, 0, 0.6);
}

/* Icons */
.button-icon {
    width: 22px;
    height: 22px;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    /* Inactive: Black 30% opacity */
    opacity: 0.3;
}

.action-button.active .button-icon {
    transform: scale(1.1);
    /* Active: Black 100% opacity */
    opacity: 1;
}

.action-button:hover .button-icon {
    /* Hover: Black 60% opacity */
    opacity: 0.6;
}

/* Ensure icons are visible by default */
.action-button .button-icon {
    display: block;
    visibility: visible;
}

/* Special voice button */
.voice-button {
    background: transparent;
}

.voice-button:hover {
    background: transparent;
}

.voice-button.active {
    background: transparent;
}

/* Minimalistic pulse animation for active voice button */
.voice-button.active::before {
    content: '';
    position: absolute;
    top: -1px;
    left: -1px;
    right: -1px;
    bottom: -1px;
    background: rgba(0, 0, 0, 0.1);
    border-radius: 8px;
    z-index: -1;
    animation: subtlePulse 2s infinite;
}

@keyframes subtlePulse {
    0% {
        transform: scale(1);
        opacity: 0.1;
    }
    50% {
        transform: scale(1.02);
        opacity: 0.2;
    }
    100% {
        transform: scale(1);
        opacity: 0.1;
    }
}

/* Animation d'apparition des boutons */
.action-button {
    animation: slideInUp 0.6s cubic-bezier(0.4, 0, 0.2, 1) both;
}

.action-button:nth-child(1) { animation-delay: 0.1s; }
.action-button:nth-child(2) { animation-delay: 0.2s; }
.action-button:nth-child(3) { animation-delay: 0.3s; }
.action-button:nth-child(4) { animation-delay: 0.4s; }
.action-button:nth-child(5) { animation-delay: 0.5s; }

@keyframes slideInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Effet de vague lors du clic */
.action-button::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    border-radius: 50%;
    background: rgba(0, 0, 0, 0.1);
    transform: translate(-50%, -50%);
    transition: width 0.6s, height 0.6s;
}

.action-button.clicked::after {
    width: 80px;
    height: 80px;
}

/* Loading state */
.action-button.loading {
    background: rgba(0, 0, 0, 0.1);
    cursor: not-allowed;
}

.spinner {
    width: 20px;
    height: 20px;
    border: 2px solid rgba(0, 0, 0, 0.2);
    border-top: 2px solid rgba(0, 0, 0, 0.6);
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* Notifications */
.notification {
    position: fixed;
    top: 20px;
    right: 20px;
    padding: 12px 20px;
    border-radius: 8px;
    color: white;
    font-size: 14px;
    font-weight: 500;
    z-index: 10000;
    transform: translateX(100%);
    transition: transform 0.3s ease;
    max-width: 300px;
    word-wrap: break-word;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.notification.show {
    transform: translateX(0);
}

.notification.success {
    background: #10b981;
}

.notification.error {
    background: #ef4444;
}

.notification.warning {
    background: #f59e0b;
}

.notification.info {
    background: #3b82f6;
}

/* Error Popup */
.error-popup {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10001;
    opacity: 0;
    transform: scale(0.9);
    transition: all 0.3s ease;
}

.error-popup.show {
    opacity: 1;
    transform: scale(1);
}

.error-content {
    background: white;
    padding: 0;
    border-radius: 12px;
    max-width: 500px;
    color: #333;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
    overflow: hidden;
}

.error-header {
    background: #ef4444;
    color: white;
    padding: 20px;
    display: flex;
    align-items: center;
    gap: 12px;
}

.error-icon {
    font-size: 24px;
}

.error-header h3 {
    margin: 0;
    flex: 1;
    font-size: 18px;
}

.error-close {
    background: none;
    border: none;
    color: white;
    font-size: 24px;
    cursor: pointer;
    padding: 0;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: background 0.2s;
}

.error-close:hover {
    background: rgba(255, 255, 255, 0.2);
}

.error-message {
    padding: 20px;
    line-height: 1.6;
    color: #4a5568;
}

.error-actions {
    padding: 20px;
    background: #f7fafc;
    display: flex;
    justify-content: flex-end;
}

.error-button {
    background: #4299e1;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    transition: background 0.2s;
}

.error-button:hover {
    background: #3182ce;
}

/* Permission guide */
.permission-notification {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10001;
}

.permission-content {
    background: white;
    padding: 30px;
    border-radius: 12px;
    max-width: 500px;
    color: #333;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
}

.permission-content h3 {
    margin: 0 0 15px 0;
    color: #1f2937;
    font-size: 18px;
}

.permission-content p {
    margin: 0 0 15px 0;
    line-height: 1.5;
}

.permission-content ol {
    margin: 15px 0;
    padding-left: 20px;
    line-height: 1.6;
}

.permission-content li {
    margin: 8px 0;
}

.permission-content button {
    background: #3b82f6;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 6px;
    cursor: pointer;
    margin-top: 15px;
    font-size: 14px;
    font-weight: 500;
    transition: background 0.2s;
}

.permission-content button:hover {
    background: #2563eb;
}

/* Responsive pour différentes tailles d'écran */
@media (max-width: 480px) {
    .button-container {
        gap: 15px;
        padding: 0 15px;
    }
    
    .action-button {
        width: 36px;
        height: 36px;
    }
    
    .button-icon {
        width: 16px;
        height: 16px;
    }
    
    .notification {
        right: 10px;
        left: 10px;
        max-width: none;
    }
    
    .permission-content {
        margin: 20px;
        padding: 20px;
    }
}

/* ============================================= */
/* FILTER MODAL (Panneau contextuel)            */
/* ============================================= */

/* Modal principal - TRANSPARENT comme la toolbar */
.filter-modal {
    position: fixed;
    top: 50px; /* Juste après la toolbar */
    left: 0;
    right: 0;
    width: 200px;
    margin: 0 auto;

    /* Complètement transparent - pas de fond */
    background: transparent;
    border: none;
    box-shadow: none;

    /* Espacement minimaliste */
    padding: 8px 0;

    /* Animation d'apparition */
    opacity: 0;
    transform: translateY(-10px);
    max-height: 0;
    pointer-events: none;
    overflow: hidden;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    z-index: 100;
}

.filter-modal.show {
    opacity: 1;
    transform: translateY(0);
    max-height: 280px; /* Hauteur visible: 330px (fenêtre) - 50px (toolbar) = 280px */
    pointer-events: auto !important;
    overflow-y: auto !important; /* Auto permet le scroll quand nécessaire */
    overflow-x: hidden; /* Empêche le scroll horizontal */
    
    /* Scroll rapide et réactif */
    overscroll-behavior: contain;
    -webkit-overflow-scrolling: touch;
    scroll-behavior: smooth;
    
    /* Style de scrollbar personnalisé pour macOS */
    scrollbar-width: thin; /* Thin pour être discret */
    scrollbar-color: rgba(0, 0, 0, 0.3) rgba(0, 0, 0, 0.05);
}

/* Webkit scrollbar styling (Chrome, Safari, Electron) - visible et utilisable */
.filter-modal.show::-webkit-scrollbar {
    width: 8px; /* Largeur optimale */
    background: transparent;
}

.filter-modal.show::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.05);
    border-radius: 4px;
    margin: 2px 0;
}

.filter-modal.show::-webkit-scrollbar-thumb {
    background: rgba(0, 0, 0, 0.3);
    border-radius: 4px;
    min-height: 30px; /* Hauteur minimale pour être facilement saisissable */
}

.filter-modal.show::-webkit-scrollbar-thumb:hover {
    background: rgba(0, 0, 0, 0.5);
    cursor: pointer;
}

.filter-modal.show::-webkit-scrollbar-thumb:active {
    background: rgba(0, 0, 0, 0.7);
}

/* Forcer tous les éléments enfants cliquables à recevoir les événements */
.filter-modal.show * {
    pointer-events: auto !important;
}

/* S'assurer que les boutons de filtres sont bien cliquables */
.filter-modal.show .filter-option {
    pointer-events: auto !important;
    cursor: pointer !important;
}

/* Pas de gradient border - reste minimaliste */
.filter-modal .gradient-border {
    display: none;
}

/* Contenu du modal - scrollable */
.filter-content {
    position: relative;
    z-index: 1000;
    pointer-events: auto !important;
    min-height: 0;
    height: auto;
    overflow: visible;
}

/* Header caché - pas besoin de titre ni bouton fermer */
.filter-header {
    display: none;
}

/* Body avec les filtres - scrollable */
.filter-body {
    margin-bottom: 12px;
    padding-bottom: 8px;
    pointer-events: auto;
    min-height: 0; /* Permet au contenu de déborder */
}

/* Groupes d'options - compact */
.options-group {
    display: flex;
    flex-direction: column;
    gap: 6px;
    pointer-events: auto;
}

/* Sections de filtres - style épuré sans bordures */
.filter-section {
    margin-bottom: 8px;
    pointer-events: auto;
    
    /* Pas de fond - transparent pour s'intégrer au panneau */
    background: transparent;
    backdrop-filter: none;
    -webkit-backdrop-filter: none;
    border: none;
    border-radius: 0;
    padding: 6px 0;
    box-shadow: none;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: visible;
}

/* Hover effect pour les sections - simplifié */
.filter-section:hover {
    background: transparent;
    transform: none;
}

.filter-section:last-child {
    margin-bottom: 0;
}

/* Labels des sections - alignés à gauche avec police Inter */
.section-label {
    font-family: 'Inter', sans-serif;
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 1.2px;
    color: rgba(0, 0, 0, 0.5);
    margin-bottom: 6px;
    margin-top: 0;
    text-align: left;
    padding-left: 4px;
    text-shadow: 0 1px 2px rgba(255, 255, 255, 0.8);
    position: relative;
    z-index: 2;
}

/* Options de filtres - layout glassmorphism compact */
.filter-options {
    display: flex;
    gap: 5px;
    justify-content: flex-start;
    flex-wrap: wrap;
    pointer-events: auto;
    position: relative;
    z-index: 2;
    align-items: center;
}

.filter-option {
    /* Style épuré sans bordures ni fond */
    font-family: 'Inter', sans-serif;
    font-size: 9px;
    font-weight: 500;
    line-height: 1.3;
    padding: 5px 10px;
    min-height: 26px;
    border: none;
    border-radius: 5px;
    background: transparent;
    backdrop-filter: none;
    -webkit-backdrop-filter: none;
    cursor: pointer !important;
    pointer-events: auto !important;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 5px;
    position: relative;
    overflow: hidden;
    user-select: none;
    -webkit-user-select: none;
    -webkit-tap-highlight-color: transparent;
    box-shadow: none;
}

.filter-option:hover {
    background: rgba(0, 0, 0, 0.05);
    transform: none;
    box-shadow: none;
}

.filter-option:active {
    transform: scale(0.96);
    background: rgba(0, 0, 0, 0.08);
    transition: all 0.1s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: none;
}

/* État sélectionné - fond subtil */
.filter-option.selected {
    background: rgba(0, 0, 0, 0.12);
    transform: none;
    box-shadow: none;
}

/* Cacher toutes les icônes par défaut */
.filter-option-icon {
    display: none;
}

/* Texte des filtres - typographie Inter uniforme */
.filter-option span {
    font-family: 'Inter', sans-serif;
    font-size: 9px;
    font-weight: 500;
    color: rgba(0, 0, 0, 0.6);
    white-space: nowrap;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    text-shadow: none;
    pointer-events: none !important;
    letter-spacing: 0.2px;
}

.filter-option.selected span {
    color: rgba(0, 0, 0, 0.9);
    font-weight: 600;
    text-shadow: none;
}

.filter-option:hover span {
    color: rgba(0, 0, 0, 0.75);
    text-shadow: none;
}

.filter-option:active span {
    color: rgba(0, 0, 0, 0.85);
    text-shadow: none;
}

/* Drapeaux et emojis - taille harmonisée (pour Target Language uniquement) */
.filter-option[data-filter="translate-target"] span {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 9px;
}

/* Bouton d'action principal - glassmorphism compact */
.action-button-primary {
    width: 32px;
    height: 32px;
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 6px;
    background: linear-gradient(
        135deg,
        rgba(255, 255, 255, 0.45) 0%,
        rgba(245, 250, 255, 0.4) 100%
    );
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    overflow: hidden;
    margin: 8px auto 0;
    box-shadow: 
        0 2px 8px rgba(0, 0, 0, 0.08),
        inset 0 1px 0 rgba(255, 255, 255, 0.3);
}

.action-button-primary:hover {
    background: linear-gradient(
        135deg,
        rgba(255, 255, 255, 0.65) 0%,
        rgba(240, 248, 255, 0.6) 100%
    );
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border: 1px solid rgba(255, 255, 255, 0.3);
    transform: translateY(-2px);
    box-shadow: 
        0 4px 12px rgba(0, 0, 0, 0.12),
        inset 0 1px 0 rgba(255, 255, 255, 0.4);
}

.action-button-primary:active {
    transform: translateY(0) scale(0.95);
    transition: all 0.1s cubic-bezier(0.4, 0, 0.2, 1);
    background: linear-gradient(
        135deg,
        rgba(255, 255, 255, 0.55) 0%,
        rgba(248, 252, 255, 0.5) 100%
    );
    box-shadow: 
        0 2px 6px rgba(0, 0, 0, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.3);
}

.action-button-primary:disabled {
    opacity: 0.3;
    cursor: not-allowed;
    transform: none;
}

.action-button-primary-icon {
    width: 18px;
    height: 18px;
    opacity: 0.8;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.1));
}

.action-button-primary:hover .action-button-primary-icon {
    transform: scale(1.1);
    opacity: 1;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.15));
}

/* Cacher le texte du bouton lancer */
.action-button-primary span {
    display: none;
}

/* Zone de statut (montrée pendant l'exécution) */
.panel-status {
    margin-bottom: 12px;
}

.status-message {
    font-family: 'Inter', sans-serif;
    font-size: 12px;
    font-weight: 500;
    color: rgba(0, 0, 0, 0.7);
    margin-bottom: 10px;
    line-height: 1.5;
    letter-spacing: 0.2px;
}

/* Barre de progression */
.progress-bar {
    width: 100%;
    height: 4px;
    background: rgba(0, 0, 0, 0.08);
    border-radius: 2px;
    overflow: hidden;
}

.progress-fill {
    height: 100%;
    background: rgba(0, 0, 0, 0.85);
    border-radius: 2px;
    transition: width 0.3s ease;
    position: relative;
}

.progress-fill::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(
        90deg,
        transparent 0%,
        rgba(255, 255, 255, 0.3) 50%,
        transparent 100%
    );
    animation: shimmer 1.5s infinite;
}

@keyframes shimmer {
    0% { transform: translateX(-100%); }
    100% { transform: translateX(100%); }
}

/* Zone d'erreur */
.panel-error {
    background: rgba(239, 68, 68, 0.1);
    border: 1px solid rgba(239, 68, 68, 0.2);
    border-radius: 6px;
    padding: 12px;
    margin-bottom: 12px;
}

.error-message {
    font-family: 'Inter', sans-serif;
    font-size: 12px;
    font-weight: 500;
    color: rgba(153, 27, 27, 0.9);
    line-height: 1.5;
    margin-bottom: 10px;
    text-align: center;
    letter-spacing: 0.2px;
}

.retry-button {
    width: 100%;
    padding: 10px 16px;
    font-size: 13px;
    font-weight: 600;
    color: white;
    background: rgba(239, 68, 68, 0.9);
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.retry-button:hover {
    background: rgba(239, 68, 68, 1);
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
}

.retry-button:active {
    transform: scale(0.98);
}

/* Animations */
@keyframes shake {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-5px); }
    75% { transform: translateX(5px); }